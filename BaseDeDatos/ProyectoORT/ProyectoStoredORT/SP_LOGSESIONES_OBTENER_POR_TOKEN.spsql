CREATE OR REPLACE PROCEDURE ESQUEMA.SP_LOGSESIONES_OBTENER_POR_TOKEN (
IN @TOKEN VARCHAR(30)
)
	DYNAMIC RESULT SETS 1
	
P1: BEGIN

	DECLARE C1 CURSOR WITH RETURN FOR 
	SELECT 
		* 
	FROM 
		ESQUEMA.LOGSESIONES A LEFT JOIN
		ESQUEMA.PERSONAS B 
		ON A.PERSONAS_ID = B.PERSONAS_ID
	WHERE
		TOKEN = @TOKEN
		AND 
		FIN IS NULL
	;
	
	OPEN C1;
	
END P1